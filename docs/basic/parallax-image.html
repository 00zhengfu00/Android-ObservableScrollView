<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns#">
<head>
<meta charset="UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta http-equiv="Content-Language" content="en" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Parallax image | Android-ObservableScrollView</title>
<meta name="description" content="Android library to observe scroll events on scrollable views." />
<meta name="robots" content="index" />
<meta property="og:type" content="article" />
<meta property="og:site_name" content="Android-ObservableScrollView | Android library to observe scroll events on scrollable views." />
<meta property="og:title" content="Parallax image | Android-ObservableScrollView" />
<meta property="og:url" content="http://ksoichiro.github.io/Android-ObservableScrollView" />
<meta property="og:description" content="Android library to observe scroll events on scrollable views." />
<meta property="og:image" content="/Android-ObservableScrollView/thumbnail.png" />
<meta property="og:locale" content="en" />
<link rel="stylesheet" type="text/css" href="/Android-ObservableScrollView/lib/bootstrap/dist/css/bootstrap.min.css" />
<link rel="stylesheet" type="text/css" href="/Android-ObservableScrollView/css/main.css" />
<!--[if lt IE 9]>
<script src="/Android-ObservableScrollView/lib/html5shiv/dist/html5shiv.min.js"></script>
<script src="/Android-ObservableScrollView/lib/respond-minmax/dest/respond.min.js"></script>
<![endif]-->
<link rel="apple-touch-icon" sizes="57x57" href="/Android-ObservableScrollView/apple-icon-57x57.png" />
<link rel="apple-touch-icon" sizes="60x60" href="/Android-ObservableScrollView/apple-icon-60x60.png" />
<link rel="apple-touch-icon" sizes="72x72" href="/Android-ObservableScrollView/apple-icon-72x72.png" />
<link rel="apple-touch-icon" sizes="76x76" href="/Android-ObservableScrollView/apple-icon-76x76.png" />
<link rel="apple-touch-icon" sizes="114x114" href="/Android-ObservableScrollView/apple-icon-114x114.png" />
<link rel="apple-touch-icon" sizes="120x120" href="/Android-ObservableScrollView/apple-icon-120x120.png" />
<link rel="apple-touch-icon" sizes="144x144" href="/Android-ObservableScrollView/apple-icon-144x144.png" />
<link rel="apple-touch-icon" sizes="152x152" href="/Android-ObservableScrollView/apple-icon-152x152.png" />
<link rel="apple-touch-icon" sizes="180x180" href="/Android-ObservableScrollView/apple-icon-180x180.png" />
<link rel="icon" type="image/png" sizes="192x192"  href="/Android-ObservableScrollView/android-icon-192x192.png" />
<link rel="icon" type="image/png" sizes="32x32" href="/Android-ObservableScrollView/favicon-32x32.png" />
<link rel="icon" type="image/png" sizes="96x96" href="/Android-ObservableScrollView/favicon-96x96.png" />
<link rel="icon" type="image/png" sizes="16x16" href="/Android-ObservableScrollView/favicon-16x16.png" />
<link rel="manifest" href="/Android-ObservableScrollView/manifest.json" />
<meta name="msapplication-TileColor" content="#ffffff" />
<meta name="msapplication-TileImage" content="/Android-ObservableScrollView/ms-icon-144x144.png" />
<meta name="theme-color" content="#ffffff" />
<meta name="base" content="/Android-ObservableScrollView" />
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-62586232-1', 'auto');
  ga('send', 'pageview');
</script>

</head>
<body>

<nav class="navbar navbar-inverse navbar-fixed-top">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/Android-ObservableScrollView/">Android-ObservableScrollView</a>
    </div>
    <div id="navbar" class="collapse navbar-collapse">
      <ul class="nav navbar-nav">
        <li><a href="/Android-ObservableScrollView/docs/overview">Documentation</a></li>
        <li><a href="/Android-ObservableScrollView/docs/faq">FAQ</a></li>
        <li><a href="https://github.com/ksoichiro/Android-ObservableScrollView">GitHub</a></li>
      </ul>
    </div>
  </div>
</nav>


<div class="container">
<p class="visible-xs">
    <button type="button" class="btn-sidebar-toggle" data-toggle="offcanvas">Show menu</button>
</p>
<div id="grid-content">
<div id="sidebar">
    <ul>
        <li><ul><li class="topic"><a href="/Android-ObservableScrollView/docs/overview">Overview</a></li></ul></li>
        
            
            
            <li>
                <h4 class="section"><a href="/Android-ObservableScrollView/docs/quick-start/">Quick start</a></h4>
                <ul>
                    
                        
                    
                        
                            <li class="topic"><a href="/Android-ObservableScrollView/docs/quick-start/dependencies">Dependencies</a></li>
                        
                    
                        
                            <li class="topic"><a href="/Android-ObservableScrollView/docs/quick-start/layout">Layout</a></li>
                        
                    
                        
                            <li class="topic"><a href="/Android-ObservableScrollView/docs/quick-start/animation">Animation codes</a></li>
                        
                    
                </ul>
            </li>
        
            
            <li>
                <h4 class="section"><a href="/Android-ObservableScrollView/docs/example/">Try the example app</a></h4>
                <ul>
                    
                        
                    
                        
                            <li class="topic"><a href="/Android-ObservableScrollView/docs/example/google-play">Download from Google Play</a></li>
                        
                    
                        
                            <li class="topic"><a href="/Android-ObservableScrollView/docs/example/wercker">Download from wercker</a></li>
                        
                    
                        
                            <li class="topic"><a href="/Android-ObservableScrollView/docs/example/android-studio">Build on Android Studio</a></li>
                        
                    
                        
                            <li class="topic"><a href="/Android-ObservableScrollView/docs/example/eclipse">Build on Eclipse</a></li>
                        
                    
                </ul>
            </li>
        
            
            <li>
                <h4 class="section"><a href="/Android-ObservableScrollView/docs/basic/">Basic techniques</a></h4>
                <ul>
                    
                        
                    
                        
                            <li class="topic"><a href="/Android-ObservableScrollView/docs/basic/show-hide-action-bar">Show and hide the ActionBar</a></li>
                        
                    
                        
                            <li class="topic"><a href="/Android-ObservableScrollView/docs/basic/translating-toolbar">Translating the Toolbar</a></li>
                        
                    
                        
                            <li class="topic"><a href="/Android-ObservableScrollView/docs/basic/parallax-image">Parallax image</a></li>
                        
                    
                        
                            <li class="topic"><a href="/Android-ObservableScrollView/docs/basic/sticky-header">Sticky header</a></li>
                        
                    
                        
                            <li class="topic"><a href="/Android-ObservableScrollView/docs/basic/flexible-space-toolbar">Flexible space on the Toolbar</a></li>
                        
                    
                        
                            <li class="topic"><a href="/Android-ObservableScrollView/docs/basic/flexible-space-with-image">Flexible space with image</a></li>
                        
                    
                        
                            <li class="topic"><a href="/Android-ObservableScrollView/docs/basic/filling-gap">Filling gap on top of the Toolbar</a></li>
                        
                    
                </ul>
            </li>
        
            
            <li>
                <h4 class="section"><a href="/Android-ObservableScrollView/docs/advanced/">Advanced techniques</a></h4>
                <ul>
                    
                        
                    
                        
                            <li class="topic"><a href="/Android-ObservableScrollView/docs/advanced/sliding-up">Sliding up pattern</a></li>
                        
                    
                        
                            <li class="topic"><a href="/Android-ObservableScrollView/docs/advanced/viewpager">ViewPager pattern</a></li>
                        
                    
                </ul>
            </li>
        
            
            <li>
                <h4 class="section"><a href="/Android-ObservableScrollView/docs/contributor/">For contributors</a></h4>
                <ul>
                    
                        
                    
                        
                            <li class="topic"><a href="/Android-ObservableScrollView/docs/contributor/ci">CI</a></li>
                        
                    
                        
                            <li class="topic"><a href="/Android-ObservableScrollView/docs/contributor/update-website">Update website</a></li>
                        
                    
                        
                            <li class="topic"><a href="/Android-ObservableScrollView/docs/contributor/release">Release</a></li>
                        
                    
                </ul>
            </li>
        
            
            <li>
                <h4 class="section"><a href="/Android-ObservableScrollView/docs/reference/">Reference</a></h4>
                <ul>
                    
                        
                    
                        
                            <li class="topic"><a href="/Android-ObservableScrollView/docs/reference/supported-widgets">Supported widgets</a></li>
                        
                    
                        
                            <li class="topic"><a href="/Android-ObservableScrollView/docs/reference/environment">Environment</a></li>
                        
                    
                        
                            <li class="topic"><a href="/Android-ObservableScrollView/docs/reference/release-notes">Release notes</a></li>
                        
                    
                </ul>
            </li>
        
    </ul>
</div>
<div id="sidebar-main-content">
<h1>Parallax image</h1><p>This topic describes how to create parallax effect,
which are implemented in the following examples.</p>
<ul>
<li>ParallaxToolbarScrollViewActivity</li>
<li>ParallaxToolbarListViewActivity</li>
</ul>
<hr>
<h2>Overview</h2><p>In this topic, &quot;parallax&quot; means the following layout and behavior:</p>
<ul>
<li>The layout has an image on the top of the layout.</li>
<li>The image will move with half the speed of that of the ScrollView.</li>
<li>ScrollView itself has a big padding, which is like a &quot;window&quot; to see the image.</li>
</ul>
<p>To make the image &quot;parallax&quot;, we need to do some tricks on the layout.  </p>
<p><code>ObservableScrollView</code> and <code>ObservableListView</code> are a little different
around handling paddings.
I&#39;ll explain from <code>ObservableScrollView</code>.</p>
<hr>
<h2>ScrollView</h2><h3>Layout</h3><h4>Basic structure</h4><p>At first, let&#39;s see the following basic structure of the layout.</p>
<pre><code class="language-xml">&lt;FrameLayout&gt;
  &lt;ObservableScrollView&gt;
    &lt;RelativeLayout&gt;
      &lt;ImageView/&gt;
      &lt;View/&gt;
      &lt;TextView/&gt;
    &lt;/RelativeLayout&gt;
  &lt;/ObservableScrollView&gt;
  &lt;Toolbar/&gt;
&lt;/FrameLayout&gt;
</code></pre>
<p>Please note that in this XML, I intentionally omitted attributes(<code>android:XXX</code>)
and package name (<code>com.github.XXX</code>) for readability.</p>
<h5>Why should we use FrameLayout?</h5><p>As you can see on the example app, Toolbar is overlaid to the ObservableScrollView.
To do this, we need to use <code>FrameLayout</code> or <code>RelativeLayout</code>.</p>
<h5>What&#39;s inside of the ObservableScrollView?</h5><p><code>ObservableScrollView</code> extends <code>ScrollView</code>, so it can have no more than 1 child.
However we need more children, so placing a <code>ViewGroup</code> as the child of <code>ObservableScrollView</code> is required.</p>
<p><code>ImageView</code> is the <code>View</code> which is going to have &quot;parallax&quot; effect.
You can replace it to other type of <code>View</code> if you want.</p>
<p><code>TextView</code> is the main content of the screen, you can also replace it to other type of <code>View</code>.</p>
<p><code>View</code> is an &quot;anchor&quot;, I&#39;ll explain it later.</p>
<p>We need to move the content and the image separately,
so the parent of them &mdash; child of <code>ObservableScrollView</code> &mdash;
should be <code>RelativeLayout</code> or <code>FrameLayout</code>.
This time, we use <code>RelativeLayout</code> for that purpose.</p>
<h4>Don&#39;t move the content when its parent is scrolled</h4><p>How do you place the main content (a <code>TextView</code> for this time) under the <code>ImageView</code>?</p>
<p>Suppose you define the position with <code>android:layout_below</code> attribute:</p>
<pre><code class="language-xml">&lt;!-- some attributes are omitted --&gt;
&lt;RelativeLayout&gt;
  &lt;ImageView android:id=&quot;@+id/image&quot;&gt;
  &lt;TextView android:layout_below=&quot;@id/image&quot;&gt;
&lt;/RelativeLayout&gt;
</code></pre>
<p>We need to move <code>ImageView</code> but if we do this, 
the <code>TextView</code> moves with the same speed as <code>ImageView</code>
because its layout is defined with <code>android:layout_below=&quot;@id/image&quot;</code>.
So we should define the <code>TextView</code>&#39;s position with another &quot;anchor&quot; view:</p>
<pre><code class="language-xml">&lt;!-- some attributes are omitted --&gt;
&lt;RelativeLayout&gt;
  &lt;ImageView android:id=&quot;@+id/image&quot;
             android:layout_height=&quot;@dimen/parallax_image_height&quot;&gt;
  &lt;View android:id=&quot;@+id/anchor&quot;
        android:layout_height=&quot;@dimen/parallax_image_height&quot;
        android:minHeight=&quot;@dimen/parallax_image_height&quot; /&gt;
  &lt;TextView android:layout_below=&quot;@id/anchor&quot;&gt;
&lt;/RelativeLayout&gt;
</code></pre>
<p>With this anchor view, we can move only <code>ImageView</code>.
The anchor <code>View</code> and <code>TextView</code> will remain in their position.</p>
<h4>Set the content color explicitly</h4><p>We need to set the background color of the main content explicitly,
because the image is underlying.</p>
<pre><code class="language-xml">&lt;TextView android:layout_below=&quot;@id/anchor&quot;
  android:background=&quot;@android:color/white&quot; /&gt;
</code></pre>
<h4>Complete the layout</h4><p>Now set the rest of the attributes of the layout,
such as <code>android:layout_width</code>, <code>android:padding</code>, etc.<br>Please see the folloing codes for details.</p>
<ul>
<li><code>res/layout/activity_parallaxtoolbarscrollview.java</code></li>
</ul>
<h3>Animation</h3><h4>Basic structure of Activity</h4><p>We use <code>AppCompatActivity</code> of the v7 appcompat library for the base <code>Activity</code> class,
and implement <code>ObservableScrollViewCallbacks</code>.</p>
<pre><code class="language-java">public class ParallaxToolbarScrollViewActivity
  extends AppCompatActivity implements ObservableScrollViewCallbacks {
</code></pre>
<h4>Initialize views</h4><p>Then initialize the views like this.</p>
<pre><code class="language-java">// Fields
private View mImageView;
private View mToolbarView;
private ObservableScrollView mScrollView;
private int mParallaxImageHeight;

@Override
protected void onCreate(Bundle savedInstanceState) {
  super.onCreate(savedInstanceState);
  setContentView(R.layout.activity_parallaxtoolbarscrollview);

  setSupportActionBar((Toolbar) findViewById(R.id.toolbar));

  mImageView = findViewById(R.id.image);
  mToolbarView = findViewById(R.id.toolbar);
  mToolbarView.setBackgroundColor(
    ScrollUtils.getColorWithAlpha(0, getResources().getColor(R.color.primary)));

  mScrollView = (ObservableScrollView) findViewById(R.id.scroll);
  mScrollView.setScrollViewCallbacks(this);

  mParallaxImageHeight = getResources().getDimensionPixelSize(
    R.dimen.parallax_image_height);
}
</code></pre>
<p>The Toolbar should be transparent at the beginning, so set the alpha of the background color to 0
by using the <code>ScrollUtils</code> utility class.
This is optional and you can omit this if you don&#39;t use the Toolbar.</p>
<h4>Change the position on scrolling</h4><p>We use <code>onScrollChanged()</code> method, one of <code>ObservableScrollViewCallbacks</code>, to animate the view.
What we need to do in this method is:</p>
<ol>
<li>translate the <code>ImageView</code> in Y-axis using <code>scrollY</code> parameter</li>
<li>change the alpha value of the background color of the <code>Toolbar</code> using <code>scrollY</code> parameter</li>
</ol>
<p>The second one is optional. You can omit this if you don&#39;t use the Toolbar.</p>
<h5>Translate the ImageView</h5><p>Just set the <code>translateY</code> property to half of <code>scrollY</code>.<br>If you want to change the &quot;depth&quot; of the parallax effect, adjust this value (<code>scrollY / 2</code>).</p>
<pre><code class="language-java">@Override
public void onScrollChanged(int scrollY, boolean firstScroll, boolean dragging) {
  ViewHelper.setTranslationY(mImageView, scrollY / 2);
}
</code></pre>
<h5>Change the alpha of the Toolbar background color</h5><p>We should change the alpha value of the background color of the Toolbar,
so we can write like this.</p>
<pre><code class="language-java">@Override
public void onScrollChanged(int scrollY, boolean firstScroll, boolean dragging) {
  int baseColor = getResources().getColor(R.color.primary);
  float alpha = 0; // TODO Fix this value
  mToolbarView.setBackgroundColor(ScrollUtils.getColorWithAlpha(alpha, baseColor));
</code></pre>
<p>Changing alpha is a little complicated, so I wrote <code>float alpha = 0</code> temporarily.<br>Let&#39;s confirm the conditions of the colors and fix the <code>alpha</code> value.</p>
<ul>
<li>If the <code>ObservableScrollView</code> is not scrolled, Toolbar is transparent.<br>(If <code>scrollY</code> equals to 0, alpha of the Toolbar is 0.)</li>
<li>If the <code>ObservableScrollView</code> is scrolled, it becomes opaque gradually,
and when it&#39;s scrolled to a certain point, Toolbar is completely opaque.<br>(If <code>scrollY</code> equals to <code>mParallaxImageHeight</code>, alpha of the Toolbar is 1.)</li>
</ul>
<p>We need to express these conditions as a formula.</p>
<p><code>alpha</code> should changes from 0 to 1, but <code>scrollY</code> changes from 0 to thousands,
so <code>scrollY</code> should be scaled.<br>We should divide <code>scrollY</code> with <code>mParallaxImageHeight</code> because
when <code>alpha</code> becomes 1, <code>scrollY</code> should be equal to <code>mParallaxImageHeight</code>.</p>
<pre><code class="language-java">float alpha = (float) scrollY / mParallaxImageHeight;
</code></pre>
<p>Please note that <code>scrollY</code> and <code>mParallaxImageHeight</code> are both type <code>int</code>,
so you need to cast one of them to <code>float</code>.</p>
<p>But how is it when <code>scrollY</code> becomes more than <code>mParallaxImageHeight</code>?<br>Let&#39;s simulate the result values:</p>
<table>
<thead>
<tr>
<th style="text-align:right"><code>scrollY</code></th>
<th style="text-align:right"><code>mParallaxImageHeight</code></th>
<th style="text-align:right"><code>alpha</code></th>
<th>Valid alpha?</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">300</td>
<td style="text-align:right">0</td>
<td>Valid</td>
</tr>
<tr>
<td style="text-align:right">150</td>
<td style="text-align:right">300</td>
<td style="text-align:right">0.5</td>
<td>Valid</td>
</tr>
<tr>
<td style="text-align:right">300</td>
<td style="text-align:right">300</td>
<td style="text-align:right">1.0</td>
<td>Valid</td>
</tr>
<tr>
<td style="text-align:right">450</td>
<td style="text-align:right">300</td>
<td style="text-align:right"><em><strong>1.5</strong></em></td>
<td><em><strong>Invalid</strong></em></td>
</tr>
</tbody>
</table>
<p>As we can see in the 4th row (<code>scrollY == 450</code>),
we need to control <code>alpha</code> so that it will not exceed 1.0.
This time we use <code>Math.min()</code> to limit the value from 0 to 1.</p>
<pre><code class="language-java">float alpha = Math.min(1, (float) scrollY / mParallaxImageHeight);
</code></pre>
<p>Now it&#39;s done.<br><code>onScrollChanged</code> will be like this:</p>
<pre><code class="language-java">@Override
public void onScrollChanged(int scrollY, boolean firstScroll, boolean dragging) {
  int baseColor = getResources().getColor(R.color.primary);
  float alpha = Math.min(1, (float) scrollY / mParallaxImageHeight);
  mToolbarView.setBackgroundColor(ScrollUtils.getColorWithAlpha(alpha, baseColor));
  ViewHelper.setTranslationY(mImageView, scrollY / 2);
}
</code></pre>
<h4>Restore scroll state</h4><p>We need to handle one more thing: restoring scroll state when the Activity is restored.<br><code>ObservableScrollView</code> itself stores its scroll position,
so you just need to update the view
in the <code>onRestoreInstanceState()</code> method.</p>
<pre><code class="language-java">@Override
protected void onRestoreInstanceState(Bundle savedInstanceState) {
  super.onRestoreInstanceState(savedInstanceState);
  onScrollChanged(mScrollView.getCurrentScrollY(), false, false);
}
</code></pre>
<hr>
<h2>ListView</h2><p>Let&#39;s see the difference of the implementation between ListView version and ScrollView version.</p>
<h3>Layout</h3><h4>Basic structure</h4><pre><code class="language-xml">&lt;FrameLayout&gt;
  &lt;ImageView/&gt;
  &lt;View/&gt;
  &lt;ObservableListView/&gt;
  &lt;Toolbar/&gt;
&lt;/FrameLayout&gt;
</code></pre>
<p>We use <code>FrameLayout</code> to the root view, just like ScrollView pattern.<br><code>FrameLayout</code> can be used to move children views separately.</p>
<p><code>ImageView</code> is the view which should have &quot;parallax&quot; effect.</p>
<p>The next <code>View</code> is used for different purpose from that of ScrollView.
I&#39;ll explain this later.</p>
<h4>Why do we use different layout?</h4><p>Unlike ScrollView, ListView cannot have children views,
so <code>ImageView</code> should be outside of the scrollable view (ListView)
and we should move the <code>ImageView</code> manually.</p>
<h4>How do we place ImageView and ListView?</h4><p><code>ImageView</code> is going to be scrolled slower than ListView
(because we&#39;re going to make &quot;parallax&quot; effect), 
so <code>ImageView</code> should be underneath the ListView.
Otherwise, the bottom of the <code>ImageView</code> overlaps with the top of the ListView.</p>
<p>Also, ListView should have a big padding
at the top of the ListView to make <code>ImageView</code> visible.<br>We achieve this by adding a transparent header view to the ListView.</p>
<h4>Why do we need a View?</h4><p>As I mentioned above, ListView should have a transparent header,
so its background color should be also transparent.
But if we do this, not only the header view but also the items of the ListView
become transparent.</p>
<p><img src="../images/basic_1.png" alt=""></p>
<p>To avoid this, we set a dummy background view under the ListView.</p>
<h3>Animation</h3><h4>Basic structure of Activity</h4><p>It&#39;s same as <code>ParallaxToolbarScrollViewActivity</code> example.</p>
<pre><code class="language-java">public class ParallaxToolbarListViewActivity
  extends BaseActivity implements ObservableScrollViewCallbacks {
</code></pre>
<h4>Initialize views</h4><p>Like ScrollView, initialize the <code>ObservableListView</code>, <code>ImageView</code>, Toolbar, etc.<br>And as I explained, ListView should have a header view.</p>
<pre><code class="language-java">private View mImageView;
private View mToolbarView;
private View mListBackgroundView;
private ObservableListView mListView;
private int mParallaxImageHeight;

@Override
protected void onCreate(Bundle savedInstanceState) {
  super.onCreate(savedInstanceState);
  setContentView(R.layout.activity_parallaxtoolbarlistview) ;

  setSupportActionBar((Toolbar) findViewById(R.id.toolbar));

  mImageView = findViewById(R.id.image);
  mToolbarView = findViewById(R.id.toolbar);
  mToolbarView.setBackgroundColor(ScrollUtils.getColorWithAlpha(0, getResources().getColor(R.color.primary)));

  mParallaxImageHeight = getResources().getDimensionPixelSize(R.dimen.parallax_image_height);

  mListView = (ObservableListView) findViewById(R.id.list);
  mListView.setScrollViewCallbacks(this);
  // Set padding view for ListView. This is the flexible space.
  View paddingView = new View(this);
  AbsListView.LayoutParams lp = new AbsListView.LayoutParams(AbsListView.LayoutParams.MATCH_PARENT,
          mParallaxImageHeight);
  paddingView.setLayoutParams(lp);
  paddingView.setClickable(true);

  mListView.addHeaderView(paddingView);
  setDummyData(mListView);
  mListBackgroundView = findViewById(R.id.list_background);
</code></pre>
<p>Note that following code is necessary to disable header view&#39;s list selector effect.</p>
<pre><code class="language-java">  paddingView.setClickable(true);
</code></pre>
<p><code>setDummyData()</code> should be replaced to appropriate data population codes.</p>
<h4>Change the position on scrolling</h4><h5>Translate the ImageView</h5><p>We use <code>onScrollChanged</code> method to translate views.</p>
<pre><code class="language-java">@Override
public void onScrollChanged(int scrollY, boolean firstScroll, boolean dragging) {
}
</code></pre>
<p>Basically, we should just set the translateY property to half of <code>scrollY</code>.
But be careful, unlike ScrollView, when <code>scrollY</code> gets larger then <code>translateY</code> of <code>ImageView</code> should become smaller
because <code>ImageView</code> is not a child of the ListView.
So we should use <code>-scrollY / 2</code> as <code>translationY</code> (and you can adjust &quot;<code>/ 2</code>&quot; if you want).</p>
<pre><code class="language-java">ViewHelper.setTranslationY(mImageView, -scrollY / 2);
</code></pre>
<h5>Translate the background view</h5><p>The background should move with ListView, but it should have an offset <code>mParallaxImageHeight</code>
so we can write like this:</p>
<pre><code class="language-java">ViewHelper.setTranslationY(mListBackgroundView, mParallaxImageHeight - scrollY);
</code></pre>
<p>But how is it when <code>scrollY</code> becomes more than <code>mParallaxImageHeight</code>?<br>Let&#39;s simulate the result values:</p>
<table>
<thead>
<tr>
<th style="text-align:right"><code>mParallaxImageHeight</code></th>
<th style="text-align:right"><code>scrollY</code></th>
<th style="text-align:right"><code>mParallaxImageHeight - scrollY</code></th>
<th style="text-align:right">TranslationY of <code>mListViewBackgroundView</code> should be</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">300</td>
<td style="text-align:right">0</td>
<td style="text-align:right">300</td>
<td style="text-align:right">300</td>
</tr>
<tr>
<td style="text-align:right">300</td>
<td style="text-align:right">150</td>
<td style="text-align:right">150</td>
<td style="text-align:right">150</td>
</tr>
<tr>
<td style="text-align:right">300</td>
<td style="text-align:right">300</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
</tr>
<tr>
<td style="text-align:right">300</td>
<td style="text-align:right">450</td>
<td style="text-align:right">-150</td>
<td style="text-align:right">0</td>
</tr>
</tbody>
</table>
<p>The 4th <code>mParallaxImageHeight - scrollY</code> becomes negative and it&#39;s invalid.<br>So use <code>Math.max()</code> to avoid this.</p>
<pre><code class="language-java">ViewHelper.setTranslationY(mListBackgroundView, Math.max(0, -scrollY + mParallaxImageHeight));
</code></pre>
<p>That&#39;s all.<br>The rest of the codes are the same as <code>ObservableScrollView</code> example.</p>
<p><a href="../../docs/basic/sticky-header.md">Next: Sticky header &raquo;</a></p>
</div>
</div>
</div>

<div class="footer">
    <div class="btns">
        <iframe class="ghstar" src="https://ghbtns.com/github-btn.html?user=ksoichiro&repo=Android-ObservableScrollView&type=star&count=true" frameborder="0" scrolling="0" ></iframe>
        <iframe class="ghfork" src="https://ghbtns.com/github-btn.html?user=ksoichiro&repo=Android-ObservableScrollView&type=fork&count=true" frameborder="0" scrolling="0" ></iframe>
    </div>
    <div class="copyright">
        Android is a trademark of Google Inc.<br />
        © Copyright 2014, Soichiro Kashima.
    </div>
</div>

<script src="/Android-ObservableScrollView/lib/jquery/dist/jquery.min.js"></script>
<script src="/Android-ObservableScrollView/lib/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="/Android-ObservableScrollView/lib/highlightjs/highlight.pack.js"></script>
<script src="/Android-ObservableScrollView/js/main.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

</body>
</html>
